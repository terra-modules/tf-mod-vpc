# tf-mod-vpc

This module creates a VPC across availability zones with  public subnet and  private subnet in each availability zone, a NAT gateway in each public subnet and an internet gateway.

## Important note
* Amazon changed the way ASN works so we had to move away from the default ASN number.
* Old accounts from account 01 to 019 still use the old ASN numbers. Hence use tag 0.1.0
* New accounts from account 020 use tag 0.4.0


## Input Variables:

* vpc_name - vpc name  
  i.e. dcuk004-v1
* vpc_cidr - vpc cidr  
  See <a href="https://deloitteproducts.deloitteanalytics.co.uk/wiki/display/AWSMULTI/Network+Management">the network management wiki page<a> for cidrs assigned to Deloitte AWS accounts    
* vpc_public_subnets - comma separated list of public subnet cidrs
* vpc_private_subnets - comma separated list of private subnet cidrs
* region - aws region
* azs - comma separated list of AZs in which to distribute subnets
* vpc_instance_tenancy - A tenancy option for instances launched into the VPC  
  This can be set to either 'default' or 'dedicated'. In most cases it should be set to 'default' unless there is a specific requirement that justifies using dedicated hardware.

## Usage: 

Include into your terrform files the following way:

```
module "vpc" {  
  source               = "git::https://code.deloittecloud.co.uk/ITS/tf-mod-vpc.git"  
  vpc_cidr             = "172.20.10.128/26"
  azs                  = "a,b"
  region               = "eu-west-1"
  vpc_name             = "v004"
  vpc_public_subnets   = "172.20.10.128/28,172.20.10.160/28"
  vpc_private_subnets  = "172.20.10.144/28,172.20.10.176/28"
  vpc_instance_tenancy = "default"
}
```

## Outputs:

* vpc_id
* private_subnet_ids
* public_subnet_ids
* public_route_table_ids
* private_route_table_ids
* private_route_table_count
* vpc_cidr

